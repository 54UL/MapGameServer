<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>GPU Algorithms &raquo; Linear Algebra (cublasFlowCapturer) | Taskflow QuickStart</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://taskflow.github.io"><img src="taskflow_logo.png" alt="" />Taskflow</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">QuickStart</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Handbook</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="GPUAlgorithms.html">GPU Algorithms</a> &raquo;</span>
          Linear Algebra (cublasFlowCapturer)
        </h1>
        <div class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li><a href="#WhatIsBLAS">What is BLAS?</a></li>
            <li><a href="#HowToUsecublasFlowCapturer">What is a cublasFlow Capturer? Why?</a></li>
            <li>
              <a href="#DataModelOscublasFlowCapturer">Understand the Data Model</a>
              <ul>
                <li><a href="#cublasFlowCapturerDataModelExample">Example: Transform Data Layout in Matrix Multiplication</a></li>
              </ul>
            </li>
            <li><a href="#cublasFlowCapturerLevel-1">Use Level-1 Methods</a></li>
            <li>
              <a href="#cublasFlowCapturerLeve2-1">Use Level-2 Methods</a>
              <ul>
                <li><a href="#cublasFlowCapturerLevel2Example">Example: Solve a Triangular Linear System</a></li>
              </ul>
            </li>
            <li>
              <a href="#cublasFlowCapturerLevel-3">Use Level-3 Methods</a>
              <ul>
                <li><a href="#cublasFlowCapturerLevel3Example">Example: Perform General Matrix-Matrix Multiplication</a></li>
              </ul>
            </li>
            <li><a href="#cublasFlowCapturerExtension">Include Other cuBLAS Methods</a></li>
            <li><a href="#cublasFlowCapturerKnowMore">Know More About cublasFlow Capturer</a></li>
          </ul>
        </div>
<p>Taskflow provides a library <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> to program and accelerate <em>basic linear algebra subprograms</em> (BLAS) on top of <a href="https://docs.nvidia.com/cuda/cublas/index.html">cuBLAS</a>.</p><img class="m-image" src="LinearAlgebra.png" alt="Image" style="width: 50%;" /><section id="WhatIsBLAS"><h2><a href="#WhatIsBLAS">What is BLAS?</a></h2><p>The BLAS (Basic Linear Algebra Subprograms) are routines that provide standard building blocks for performing basic vector and matrix operations. There are three levels:</p><ol><li>Level 1: performs scalar, vector, and vector-vector operations</li><li>Level 2: performs matrix-vector operations</li><li>Level 3: performs matrix-matrix operations</li></ol><p>BLAS is commonly used by linear algebra software. The <a href="https://docs.nvidia.com/cuda/cublas/index.html">cuBLAS</a> library is an implementation of BLAS (Basic Linear Algebra Subprograms) on top of the Nvidia CUDA runtime and it allows users to access the computational resources of Nvidia GPUs.</p></section><section id="HowToUsecublasFlowCapturer"><h2><a href="#HowToUsecublasFlowCapturer">What is a cublasFlow Capturer? Why?</a></h2><p><a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> provides an interface over native cuBLAS functions and allows users to express linear algebra algorithms using a <em>task graph model</em>. We transform the task graph into a CUDA graph using a stream capture algorithm optimized for maximum concurrency. When a cuBLAS program is transformed into a CUDA graph, we can launch the entire graph using a single kernel call. This organization minimizes kernels launch overhead and allows the CUDA runtime to optimize the whole workflow. The following example (<code>cublasflow.cu</code>) use <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> to perform a 2-norm operation on a vector.</p><pre class="m-code"><span class="cp">#include</span> <span class="cpf">&lt;taskflow/cublasflow.hpp&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">const</span> <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">1024</span><span class="p">;</span>
  
  <span class="n">tf</span><span class="o">::</span><span class="n">Executor</span> <span class="n">executor</span><span class="p">;</span>
  <span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span> <span class="n">taskflow</span><span class="p">(</span><span class="s">&quot;cublas 2-norm&quot;</span><span class="p">);</span>  <span class="c1">// initialize an unit vector</span>
  
  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">hvec</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span> 
  <span class="kt">float</span>  <span class="n">hres</span><span class="p">;</span>                                     <span class="c1">// cpu vector</span>
  <span class="kt">float</span><span class="o">*</span> <span class="n">gvec</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">N</span><span class="p">);</span>  <span class="c1">// gpu vector</span>
  <span class="kt">float</span><span class="o">*</span> <span class="n">gres</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>  <span class="c1">// gpu result</span>
  
  <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">cudaFlowCapturer</span><span class="o">&amp;</span> <span class="n">capturer</span><span class="p">){</span>
    <span class="c1">// create a cuBLAS flow capturer</span>
    <span class="k">auto</span> <span class="n">blas</span> <span class="o">=</span> <span class="n">capturer</span><span class="p">.</span><span class="n">make_capturer</span><span class="o">&lt;</span><span class="n">tf</span><span class="o">::</span><span class="n">cublasFlowCapturer</span><span class="o">&gt;</span><span class="p">();</span>
    
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">h2d</span> <span class="o">=</span> <span class="n">capturer</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">gvec</span><span class="p">,</span> <span class="n">hvec</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">N</span><span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;h2d&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">nrm</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">nrm2</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">gvec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">gres</span><span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;2-norm&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">d2h</span> <span class="o">=</span> <span class="n">capturer</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">hres</span><span class="p">,</span> <span class="n">gres</span><span class="p">,</span> <span class="mi">1</span><span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;d2h&quot;</span><span class="p">);</span>
  
    <span class="n">nrm</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">d2h</span><span class="p">)</span>
       <span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">h2d</span><span class="p">);</span>
  <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;capturer&quot;</span><span class="p">);</span>
  
  <span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span>
  
  <span class="n">taskflow</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="p">);</span>
  
  <span class="n">assert</span><span class="p">(</span><span class="n">hres</span> <span class="o">==</span> <span class="mi">32</span><span class="p">);</span>
<span class="p">}</span></pre><div class="m-graph"><svg style="width: 28.812rem; height: 9.000rem;" viewBox="0.00 0.00 460.62 144.00">
<g transform="scale(1 1) rotate(0) translate(4 140)">
<title>Taskflow</title>
<g class="m-cluster">
<title>cluster_p0x7ffe27cbbb00</title>
<polygon points="8,-8 8,-128 444.62,-128 444.62,-8 8,-8"/>
<text text-anchor="middle" x="226.31" y="-111.2">Taskflow: cublas 2&#45;norm</text>
</g>
<g class="m-cluster">
<title>cluster_p0x190c880</title>
<polygon points="16,-16 16,-94 436.62,-94 436.62,-16 16,-16"/>
<text text-anchor="middle" x="226.31" y="-77.2">cudaFlow: capturer</text>
</g>
<g class="m-node">
<title>p0x190c880</title>
<polygon points="428.62,-60 425.62,-64 404.62,-64 401.62,-60 352.62,-60 352.62,-24 428.62,-24 428.62,-60"/>
<text text-anchor="middle" x="390.62" y="-38.2">capturer</text>
</g>
<g class="m-node m-flat">
<title>p0x7f05aa4b43b0</title>
<ellipse cx="55.11" cy="-42" rx="31.23" ry="18.27"/>
<text text-anchor="middle" x="55.11" y="-38.2">h2d</text>
</g>
<g class="m-node m-flat">
<title>p0x7f05aa4b4470</title>
<ellipse cx="170.31" cy="-42" rx="48.17" ry="18.27"/>
<text text-anchor="middle" x="170.31" y="-38.2">2&#45;norm</text>
</g>
<g class="m-edge">
<title>p0x7f05aa4b43b0&#45;&gt;p0x7f05aa4b4470</title>
<path d="M86.45,-42C94.26,-42 102.93,-42 111.64,-42"/>
<polygon points="111.82,-45.5 121.82,-42 111.82,-38.5 111.82,-45.5"/>
</g>
<g class="m-node m-flat">
<title>p0x7f05aa4b4540</title>
<ellipse cx="285.5" cy="-42" rx="31.23" ry="18.27"/>
<text text-anchor="middle" x="285.5" y="-38.2">d2h</text>
</g>
<g class="m-edge">
<title>p0x7f05aa4b4470&#45;&gt;p0x7f05aa4b4540</title>
<path d="M218.66,-42C227.09,-42 235.81,-42 244.03,-42"/>
<polygon points="244.12,-45.5 254.12,-42 244.12,-38.5 244.12,-45.5"/>
</g>
<g class="m-edge">
<title>p0x7f05aa4b4540&#45;&gt;p0x190c880</title>
<path d="M316.88,-42C324.91,-42 333.77,-42 342.46,-42"/>
<polygon points="342.52,-45.5 352.52,-42 342.52,-38.5 342.52,-45.5"/>
</g>
</g>
</svg>
</div><p>You need to link the <code>cublas</code> library when compiling a cublasFlow capturer program:</p><pre class="m-console"><span class="go">~$ nvcc cublasflow.cpp -I path/to/taskflow/include -lcublas</span></pre><p>Please refer to the page <a href="CompileTaskflowWithCUDA.html" class="m-doc">Compile Taskflow with CUDA</a> for more details about compiling Taskflow with CUDA.</p></section><section id="DataModelOscublasFlowCapturer"><h2><a href="#DataModelOscublasFlowCapturer">Understand the Data Model</a></h2><p>The data pointers used within <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> must sit in GPU memory space, including scalar pointers (<code>alpha</code> and <code>beta</code>), input pointers (e.g., vectors, matrices), and output pointers (e.g., result). By default, we set the pointer mode to <code>CUBLAS_POINTER_MODE_DEVICE</code>. You must allocate required matrices and vectors in the GPU memory space, fill them with data, call the methods defined in <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a>, and then upload the results from GPU memory space back to the host.</p><aside class="m-note m-info"><h4>Note</h4><p><a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> currently supports only <code>float</code> and <code>double</code> data types.</p></aside><p>The cuBLAS library uses <em>column-major storage</em> and 1-based indexing. Since C/C++ adopts row-major layout, we cannot use the native array semantics when matrix-matrix or matrix-vector operations are involved. We often need extra transposition on input matrices before these operations can take place correctly. In terms of storage, a row-major matrix is equivalent to a transposed column-major matrix, as shown below:</p><div class="m-math"><svg style="width: 15.826em; height: 1.551em;" viewBox="118.0554 -14.887683 151.934062 14.887683">
<title>
\[ A_{RowMajor} \iff A^T_{ColumnMajor} \]
</title>
<defs>
<path id='eq1-g0-40' d='M10.867248-1.590037C11.070486-1.590037 11.285679-1.590037 11.285679-1.829141S11.070486-2.068244 10.855293-2.068244H3.263761C2.761644-2.49863 2.15193-2.809465 1.75741-2.988792C2.187796-3.180075 2.773599-3.490909 3.263761-3.90934H10.855293C11.070486-3.90934 11.285679-3.90934 11.285679-4.148443S11.070486-4.387547 10.867248-4.387547H3.801743C4.375592-4.937484 4.99726-5.989539 4.99726-6.144956C4.99726-6.276463 4.841843-6.276463 4.770112-6.276463C4.674471-6.276463 4.590785-6.276463 4.542964-6.180822C4.291905-5.726526 3.957161-5.092902 3.180075-4.399502C2.355168-3.670237 1.554172-3.347447 .932503-3.16812C.729265-3.096389 .71731-3.084433 .6934-3.060523C.669489-3.048568 .669489-3.012702 .669489-2.988792S.669489-2.940971 .681445-2.917061L.71731-2.893151C.74122-2.881196 .753176-2.86924 .980324-2.797509C2.594271-2.319303 3.789788-1.231382 4.459278 .047821C4.590785 .286924 4.60274 .298879 4.770112 .298879C4.841843 .298879 4.99726 .298879 4.99726 .167372C4.99726 .011955 4.387547-1.028144 3.801743-1.590037H10.867248Z'/>
<path id='eq1-g0-41' d='M8.679452-3.90934C9.181569-3.478954 9.791283-3.16812 10.185803-2.988792C9.755417-2.797509 9.169614-2.486675 8.679452-2.068244H1.08792C.884682-2.068244 .657534-2.068244 .657534-1.829141S.872727-1.590037 1.075965-1.590037H8.141469C7.567621-1.0401 6.945953 .011955 6.945953 .167372C6.945953 .298879 7.10137 .298879 7.173101 .298879C7.268742 .298879 7.352428 .298879 7.400249 .203238C7.651308-.251059 7.986052-.884682 8.763138-1.578082C9.588045-2.307347 10.389041-2.630137 11.01071-2.809465C11.213948-2.881196 11.225903-2.893151 11.249813-2.917061C11.273724-2.929016 11.273724-2.964882 11.273724-2.988792S11.273724-3.036613 11.261768-3.060523L11.225903-3.084433C11.201993-3.096389 11.190037-3.108344 10.962889-3.180075C9.348941-3.658281 8.153425-4.746202 7.483935-6.025405C7.352428-6.264508 7.340473-6.276463 7.173101-6.276463C7.10137-6.276463 6.945953-6.276463 6.945953-6.144956C6.945953-5.989539 7.555666-4.94944 8.141469-4.387547H1.075965C.872727-4.387547 .657534-4.387547 .657534-4.148443S.884682-3.90934 1.08792-3.90934H8.679452Z'/>
<path id='eq1-g1-67' d='M6.344209-5.395766C6.352179-5.427646 6.36812-5.475467 6.36812-5.515318C6.36812-5.571108 6.320299-5.610959 6.264508-5.610959S6.184807-5.587049 6.121046-5.515318L5.563138-4.901619C5.491407-5.00523 5.068991-5.610959 4.136488-5.610959C2.287422-5.610959 .422416-3.897385 .422416-2.064259C.422416-.67746 1.474471 .167372 2.741719 .167372C3.785803 .167372 4.670486-.470237 5.100872-1.091905C5.363885-1.482441 5.467497-1.865006 5.467497-1.912827C5.467497-1.984558 5.419676-2.016438 5.347945-2.016438C5.252304-2.016438 5.236364-1.976588 5.212453-1.888917C4.877709-.789041 3.801743-.095641 2.84533-.095641C2.032379-.095641 1.179577-.573848 1.179577-1.793275C1.179577-2.048319 1.267248-3.379328 2.15193-4.375592C2.749689-5.045081 3.56264-5.347945 4.192279-5.347945C5.196513-5.347945 5.610959-4.542964 5.610959-3.785803C5.610959-3.674222 5.579078-3.52279 5.579078-3.427148C5.579078-3.323537 5.68269-3.323537 5.71457-3.323537C5.818182-3.323537 5.834122-3.355417 5.866002-3.498879L6.344209-5.395766Z'/>
<path id='eq1-g1-77' d='M7.738979-4.798007C7.81868-5.108842 7.83462-5.180573 8.392528-5.180573C8.575841-5.180573 8.671482-5.180573 8.671482-5.332005C8.671482-5.443587 8.56787-5.443587 8.424408-5.443587H7.396264C7.181071-5.443587 7.157161-5.443587 7.053549-5.284184L4.048817-.73325L3.339477-5.228394C3.307597-5.427646 3.299626-5.443587 3.060523-5.443587H1.984558C1.841096-5.443587 1.737484-5.443587 1.737484-5.292154C1.737484-5.180573 1.841096-5.180573 1.968618-5.180573C2.231631-5.180573 2.462765-5.180573 2.462765-5.053051C2.462765-5.021171 2.454795-5.0132 2.430884-4.909589L1.41868-.852802C1.323039-.454296 1.115816-.278954 .581818-.263014C.533998-.263014 .438356-.255044 .438356-.111582C.438356-.063761 .478207 0 .557908 0C.589788 0 .773101-.02391 1.346949-.02391C1.976588-.02391 2.096139 0 2.16787 0C2.199751 0 2.319303 0 2.319303-.151432C2.319303-.247073 2.231631-.263014 2.175841-.263014C1.888917-.270984 1.649813-.318804 1.649813-.597758C1.649813-.637609 1.673724-.749191 1.673724-.757161L2.757659-5.084932H2.765629L3.53873-.215193C3.56264-.087671 3.57061 0 3.682192 0S3.849564-.087671 3.897385-.159402L7.173101-5.148692L7.181071-5.140722L6.057285-.629639C5.985554-.326775 5.969614-.263014 5.379826-.263014C5.228394-.263014 5.132752-.263014 5.132752-.111582C5.132752-.079701 5.156663 0 5.260274 0S5.602989-.01594 5.71457-.02391H6.224658C6.965878-.02391 7.157161 0 7.212951 0C7.260772 0 7.372354 0 7.372354-.151432C7.372354-.263014 7.268742-.263014 7.13325-.263014C7.10934-.263014 6.965878-.263014 6.830386-.278954C6.663014-.294894 6.647073-.318804 6.647073-.390535C6.647073-.430386 6.663014-.478207 6.670984-.518057L7.738979-4.798007Z'/>
<path id='eq1-g1-82' d='M3.092403-4.885679C3.164134-5.156663 3.172105-5.180573 3.498879-5.180573H4.144458C4.798007-5.180573 5.411706-5.0132 5.411706-4.367621C5.411706-4.016936 5.228394-3.459029 4.861768-3.196015C4.479203-2.925031 4.024907-2.83736 3.56264-2.83736H2.582316L3.092403-4.885679ZM4.447323-2.709838C5.427646-2.956912 6.192777-3.55467 6.192777-4.23213C6.192777-4.925529 5.411706-5.443587 4.303861-5.443587H1.952677C1.809215-5.443587 1.705604-5.443587 1.705604-5.292154C1.705604-5.180573 1.809215-5.180573 1.936737-5.180573C2.199751-5.180573 2.430884-5.180573 2.430884-5.053051C2.430884-5.021171 2.422914-5.0132 2.399004-4.909589L1.331009-.629639C1.259278-.326775 1.243337-.263014 .653549-.263014C.502117-.263014 .406476-.263014 .406476-.111582C.406476-.079701 .430386 0 .533998 0C.68543 0 .868742-.01594 1.028144-.02391H1.522291C2.263512-.02391 2.494645 0 2.542466 0S2.701868 0 2.701868-.151432C2.701868-.263014 2.598257-.263014 2.462765-.263014C2.438854-.263014 2.295392-.263014 2.1599-.278954C1.992528-.294894 1.976588-.318804 1.976588-.390535C1.976588-.430386 1.992528-.478207 2.000498-.518057L2.518555-2.614197H3.55467C4.27198-2.614197 4.495143-2.231631 4.495143-1.904857C4.495143-1.793275 4.439352-1.570112 4.399502-1.40274C4.335741-1.171606 4.25604-.852802 4.25604-.70934C4.25604-.095641 4.782067 .167372 5.371856 .167372C6.065255 .167372 6.39203-.613699 6.39203-.765131C6.39203-.797011 6.36812-.876712 6.264508-.876712C6.176837-.876712 6.152927-.804981 6.144956-.773101C5.969614-.223163 5.626899-.055791 5.395766-.055791C5.100872-.055791 5.068991-.278954 5.068991-.541968S5.116812-1.155666 5.148692-1.41868C5.180573-1.657783 5.180573-1.705604 5.180573-1.785305C5.180573-2.263512 4.869738-2.542466 4.447323-2.709838Z'/>
<path id='eq1-g1-84' d='M3.602491-4.821918C3.674222-5.108842 3.682192-5.124782 4.008966-5.124782H4.614695C5.443587-5.124782 5.539228-4.861768 5.539228-4.463263C5.539228-4.26401 5.491407-3.921295 5.483437-3.881445C5.467497-3.793773 5.459527-3.722042 5.459527-3.706102C5.459527-3.602491 5.531258-3.57858 5.579078-3.57858C5.66675-3.57858 5.69863-3.626401 5.72254-3.777833L5.937733-5.276214C5.937733-5.387796 5.842092-5.387796 5.69863-5.387796H1.004234C.804981-5.387796 .789041-5.387796 .73325-5.220423L.247073-3.841594C.231133-3.801743 .207223-3.737983 .207223-3.690162C.207223-3.626401 .263014-3.57858 .326775-3.57858C.414446-3.57858 .430386-3.618431 .478207-3.753923C.932503-5.029141 1.163636-5.124782 2.375093-5.124782H2.685928C2.925031-5.124782 2.933001-5.116812 2.933001-5.053051C2.933001-5.029141 2.901121-4.869738 2.893151-4.837858L1.841096-.653549C1.769365-.350685 1.745455-.263014 .916563-.263014C.661519-.263014 .581818-.263014 .581818-.111582C.581818-.103611 .581818 0 .71731 0C.932503 0 1.482441-.02391 1.697634-.02391H2.375093C2.598257-.02391 3.156164 0 3.379328 0C3.443088 0 3.56264 0 3.56264-.151432C3.56264-.263014 3.474969-.263014 3.259776-.263014C3.068493-.263014 3.004732-.263014 2.797509-.278954C2.542466-.302864 2.510585-.334745 2.510585-.438356C2.510585-.470237 2.518555-.502117 2.542466-.581818L3.602491-4.821918Z'/>
<path id='eq1-g1-97' d='M3.124284-3.036613C3.052553-3.172105 2.82142-3.514819 2.335243-3.514819C1.3868-3.514819 .342715-2.406974 .342715-1.227397C.342715-.398506 .876712 .079701 1.490411 .079701C2.000498 .079701 2.438854-.326775 2.582316-.486177C2.725778 .063761 3.267746 .079701 3.363387 .079701C3.730012 .079701 3.913325-.223163 3.977086-.358655C4.136488-.645579 4.24807-1.107846 4.24807-1.139726C4.24807-1.187547 4.216189-1.243337 4.120548-1.243337S4.008966-1.195517 3.961146-.996264C3.849564-.557908 3.698132-.143462 3.387298-.143462C3.203985-.143462 3.132254-.294894 3.132254-.518057C3.132254-.653549 3.203985-.924533 3.251806-1.123786S3.419178-1.801245 3.451059-1.944707L3.610461-2.550436C3.650311-2.741719 3.737983-3.076463 3.737983-3.116314C3.737983-3.299626 3.58655-3.363387 3.482939-3.363387C3.363387-3.363387 3.164134-3.283686 3.124284-3.036613ZM2.582316-.860772C2.183811-.310834 1.769365-.143462 1.514321-.143462C1.147696-.143462 .964384-.478207 .964384-.892653C.964384-1.267248 1.179577-2.12005 1.354919-2.470735C1.586052-2.956912 1.976588-3.291656 2.343213-3.291656C2.86127-3.291656 3.012702-2.709838 3.012702-2.614197C3.012702-2.582316 2.81345-1.801245 2.765629-1.594022C2.662017-1.219427 2.662017-1.203487 2.582316-.860772Z'/>
<path id='eq1-g1-106' d='M3.291656-4.97335C3.291656-5.124782 3.172105-5.276214 2.980822-5.276214C2.741719-5.276214 2.534496-5.053051 2.534496-4.845828C2.534496-4.694396 2.654047-4.542964 2.84533-4.542964C3.084433-4.542964 3.291656-4.766127 3.291656-4.97335ZM1.625903 .398506C1.506351 .884682 1.115816 1.40274 .629639 1.40274C.502117 1.40274 .382565 1.370859 .366625 1.362889C.613699 1.243337 .645579 1.028144 .645579 .956413C.645579 .765131 .502117 .661519 .334745 .661519C.103611 .661519-.111582 .860772-.111582 1.123786C-.111582 1.42665 .183313 1.625903 .637609 1.625903C1.123786 1.625903 2.000498 1.323039 2.239601 .366625L2.956912-2.486675C2.980822-2.582316 2.996762-2.646077 2.996762-2.765629C2.996762-3.203985 2.646077-3.514819 2.183811-3.514819C1.338979-3.514819 .844832-2.399004 .844832-2.295392C.844832-2.223661 .900623-2.191781 .964384-2.191781C1.052055-2.191781 1.060025-2.215691 1.115816-2.335243C1.354919-2.885181 1.761395-3.291656 2.1599-3.291656C2.327273-3.291656 2.422914-3.180075 2.422914-2.917061C2.422914-2.805479 2.399004-2.693898 2.375093-2.582316L1.625903 .398506Z'/>
<path id='eq1-g1-108' d='M2.088169-5.292154C2.096139-5.308095 2.12005-5.411706 2.12005-5.419676C2.12005-5.459527 2.088169-5.531258 1.992528-5.531258L1.187547-5.467497C.892653-5.443587 .828892-5.435616 .828892-5.292154C.828892-5.180573 .940473-5.180573 1.036115-5.180573C1.41868-5.180573 1.41868-5.132752 1.41868-5.061021C1.41868-5.037111 1.41868-5.021171 1.378829-4.877709L.390535-.924533C.358655-.797011 .358655-.67746 .358655-.669489C.358655-.175342 .765131 .079701 1.163636 .079701C1.506351 .079701 1.689664-.191283 1.777335-.366625C1.920797-.629639 2.040349-1.099875 2.040349-1.139726C2.040349-1.187547 2.016438-1.243337 1.912827-1.243337C1.841096-1.243337 1.817186-1.203487 1.817186-1.195517C1.801245-1.171606 1.761395-1.028144 1.737484-.940473C1.617933-.478207 1.466501-.143462 1.179577-.143462C.988294-.143462 .932503-.326775 .932503-.518057C.932503-.669489 .956413-.757161 .980324-.860772L2.088169-5.292154Z'/>
<path id='eq1-g1-109' d='M1.594022-1.307098C1.617933-1.42665 1.697634-1.729514 1.721544-1.849066C1.745455-1.928767 1.793275-2.12005 1.809215-2.199751C1.825156-2.239601 2.088169-2.757659 2.438854-3.020672C2.709838-3.227895 2.972852-3.291656 3.196015-3.291656C3.490909-3.291656 3.650311-3.116314 3.650311-2.749689C3.650311-2.558406 3.602491-2.375093 3.514819-2.016438C3.459029-1.809215 3.323537-1.275218 3.275716-1.060025L3.156164-.581818C3.116314-.446326 3.060523-.207223 3.060523-.167372C3.060523 .01594 3.211955 .079701 3.315567 .079701C3.459029 .079701 3.57858-.01594 3.634371-.111582C3.658281-.159402 3.722042-.430386 3.761893-.597758L3.945205-1.307098C3.969116-1.42665 4.048817-1.729514 4.072727-1.849066C4.184309-2.279452 4.184309-2.287422 4.367621-2.550436C4.630635-2.940971 5.00523-3.291656 5.539228-3.291656C5.826152-3.291656 5.993524-3.124284 5.993524-2.749689C5.993524-2.311333 5.65878-1.39477 5.507347-1.012204C5.427646-.804981 5.403736-.749191 5.403736-.597758C5.403736-.143462 5.778331 .079701 6.121046 .079701C6.902117 .079701 7.228892-1.036115 7.228892-1.139726C7.228892-1.219427 7.165131-1.243337 7.10934-1.243337C7.013699-1.243337 6.997758-1.187547 6.973848-1.107846C6.782565-.446326 6.447821-.143462 6.144956-.143462C6.017435-.143462 5.953674-.223163 5.953674-.406476S6.017435-.765131 6.097136-.964384C6.216687-1.267248 6.567372-2.183811 6.567372-2.630137C6.567372-3.227895 6.152927-3.514819 5.579078-3.514819C5.029141-3.514819 4.574844-3.227895 4.216189-2.733748C4.152428-3.371357 3.642341-3.514819 3.227895-3.514819C2.86127-3.514819 2.375093-3.387298 1.936737-2.81345C1.880946-3.291656 1.498381-3.514819 1.123786-3.514819C.844832-3.514819 .645579-3.347447 .510087-3.076463C.318804-2.701868 .239103-2.311333 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.223661 .526027-2.430884C.621669-2.82142 .765131-3.291656 1.099875-3.291656C1.307098-3.291656 1.354919-3.092403 1.354919-2.917061C1.354919-2.773599 1.315068-2.622167 1.251308-2.359153C1.235367-2.295392 1.115816-1.825156 1.083935-1.713574L.789041-.518057C.757161-.398506 .70934-.199253 .70934-.167372C.70934 .01594 .860772 .079701 .964384 .079701C1.107846 .079701 1.227397-.01594 1.283188-.111582C1.307098-.159402 1.370859-.430386 1.41071-.597758L1.594022-1.307098Z'/>
<path id='eq1-g1-110' d='M1.594022-1.307098C1.617933-1.42665 1.697634-1.729514 1.721544-1.849066C1.833126-2.279452 1.833126-2.287422 2.016438-2.550436C2.279452-2.940971 2.654047-3.291656 3.188045-3.291656C3.474969-3.291656 3.642341-3.124284 3.642341-2.749689C3.642341-2.311333 3.307597-1.40274 3.156164-1.012204C3.052553-.749191 3.052553-.70137 3.052553-.597758C3.052553-.143462 3.427148 .079701 3.769863 .079701C4.550934 .079701 4.877709-1.036115 4.877709-1.139726C4.877709-1.219427 4.813948-1.243337 4.758157-1.243337C4.662516-1.243337 4.646575-1.187547 4.622665-1.107846C4.431382-.454296 4.096638-.143462 3.793773-.143462C3.666252-.143462 3.602491-.223163 3.602491-.406476S3.666252-.765131 3.745953-.964384C3.865504-1.267248 4.216189-2.183811 4.216189-2.630137C4.216189-3.227895 3.801743-3.514819 3.227895-3.514819C2.582316-3.514819 2.16787-3.124284 1.936737-2.82142C1.880946-3.259776 1.530262-3.514819 1.123786-3.514819C.836862-3.514819 .637609-3.331507 .510087-3.084433C.318804-2.709838 .239103-2.311333 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.223661 .526027-2.430884C.621669-2.82142 .765131-3.291656 1.099875-3.291656C1.307098-3.291656 1.354919-3.092403 1.354919-2.917061C1.354919-2.773599 1.315068-2.622167 1.251308-2.359153C1.235367-2.295392 1.115816-1.825156 1.083935-1.713574L.789041-.518057C.757161-.398506 .70934-.199253 .70934-.167372C.70934 .01594 .860772 .079701 .964384 .079701C1.107846 .079701 1.227397-.01594 1.283188-.111582C1.307098-.159402 1.370859-.430386 1.41071-.597758L1.594022-1.307098Z'/>
<path id='eq1-g1-111' d='M3.969116-2.13599C3.969116-2.917061 3.411208-3.514819 2.582316-3.514819C1.45056-3.514819 .350685-2.414944 .350685-1.299128C.350685-.486177 .924533 .079701 1.737484 .079701C2.87721 .079701 3.969116-1.036115 3.969116-2.13599ZM1.745455-.143462C1.466501-.143462 .996264-.286924 .996264-1.020174C.996264-1.346949 1.147696-2.207721 1.530262-2.701868C1.920797-3.203985 2.359153-3.291656 2.574346-3.291656C2.901121-3.291656 3.323537-3.092403 3.323537-2.422914C3.323537-2.10411 3.180075-1.346949 2.87721-.868742C2.582316-.414446 2.14396-.143462 1.745455-.143462Z'/>
<path id='eq1-g1-114' d='M1.538232-1.099875C1.625903-1.44259 1.713574-1.785305 1.793275-2.13599C1.801245-2.15193 1.857036-2.383064 1.865006-2.422914C1.888917-2.494645 2.088169-2.82142 2.295392-3.020672C2.550436-3.251806 2.82142-3.291656 2.964882-3.291656C3.052553-3.291656 3.196015-3.283686 3.307597-3.188045C2.964882-3.116314 2.917061-2.82142 2.917061-2.749689C2.917061-2.574346 3.052553-2.454795 3.227895-2.454795C3.443088-2.454795 3.682192-2.630137 3.682192-2.948941C3.682192-3.235866 3.435118-3.514819 2.980822-3.514819C2.438854-3.514819 2.072229-3.156164 1.904857-2.940971C1.745455-3.514819 1.203487-3.514819 1.123786-3.514819C.836862-3.514819 .637609-3.331507 .510087-3.084433C.326775-2.725778 .239103-2.319303 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.223661 .526027-2.430884C.621669-2.82142 .765131-3.291656 1.099875-3.291656C1.307098-3.291656 1.354919-3.092403 1.354919-2.917061C1.354919-2.773599 1.315068-2.622167 1.251308-2.359153C1.235367-2.295392 1.115816-1.825156 1.083935-1.713574L.789041-.518057C.757161-.398506 .70934-.199253 .70934-.167372C.70934 .01594 .860772 .079701 .964384 .079701C1.243337 .079701 1.299128-.143462 1.362889-.414446L1.538232-1.099875Z'/>
<path id='eq1-g1-117' d='M2.988792-.868742C2.948941-.71731 2.574346-.143462 2.040349-.143462C1.649813-.143462 1.514321-.430386 1.514321-.789041C1.514321-1.259278 1.793275-1.976588 1.968618-2.422914C2.048319-2.622167 2.072229-2.693898 2.072229-2.83736C2.072229-3.275716 1.721544-3.514819 1.354919-3.514819C.565878-3.514819 .239103-2.391034 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.239601 .494147-2.319303C.70137-3.028643 1.052055-3.291656 1.331009-3.291656C1.45056-3.291656 1.522291-3.211955 1.522291-3.028643S1.45056-2.662017 1.346949-2.383064C1.012204-1.538232 .940473-1.195517 .940473-.908593C.940473-.127522 1.530262 .079701 2.000498 .079701C2.598257 .079701 2.964882-.398506 2.996762-.438356C3.124284-.063761 3.482939 .079701 3.769863 .079701C4.144458 .079701 4.327771-.239103 4.383562-.358655C4.542964-.645579 4.654545-1.107846 4.654545-1.139726C4.654545-1.187547 4.622665-1.243337 4.527024-1.243337S4.415442-1.203487 4.367621-.996264C4.26401-.597758 4.120548-.143462 3.793773-.143462C3.610461-.143462 3.53873-.294894 3.53873-.518057C3.53873-.653549 3.610461-.924533 3.658281-1.123786S3.825654-1.801245 3.857534-1.944707L4.016936-2.550436C4.064757-2.765629 4.160399-3.140224 4.160399-3.188045C4.160399-3.387298 4.000996-3.435118 3.905355-3.435118C3.793773-3.435118 3.618431-3.363387 3.56264-3.172105L2.988792-.868742Z'/>
<path id='eq1-g1-119' d='M3.905355-2.606227C3.953176-2.797509 4.040847-3.140224 4.040847-3.188045C4.040847-3.387298 3.881445-3.435118 3.785803-3.435118C3.506849-3.435118 3.459029-3.235866 3.363387-2.86924C3.259776-2.454795 3.227895-2.303362 3.108344-1.849066C3.036613-1.546202 2.940971-1.171606 2.940971-.940473C2.940971-.900623 2.948941-.836862 2.948941-.797011C2.948941-.789041 2.733748-.143462 2.207721-.143462C1.888917-.143462 1.530262-.270984 1.530262-.860772C1.530262-1.251308 1.713574-1.769365 1.968618-2.414944C2.048319-2.622167 2.072229-2.693898 2.072229-2.83736C2.072229-3.275716 1.721544-3.514819 1.354919-3.514819C.565878-3.514819 .239103-2.391034 .239103-2.295392C.239103-2.223661 .294894-2.191781 .358655-2.191781C.462267-2.191781 .470237-2.239601 .494147-2.319303C.70137-3.012702 1.044085-3.291656 1.331009-3.291656C1.45056-3.291656 1.522291-3.211955 1.522291-3.028643C1.522291-2.86127 1.458531-2.677958 1.40274-2.534496C1.091905-1.737484 .948443-1.315068 .948443-.964384C.948443-.151432 1.617933 .079701 2.175841 .079701C2.303362 .079701 2.717808 .079701 3.044583-.446326C3.267746-.01594 3.769863 .079701 4.112578 .079701C4.829888 .079701 5.164633-.589788 5.308095-.868742C5.563138-1.3868 5.842092-2.430884 5.842092-2.901121C5.842092-3.52279 5.483437-3.52279 5.451557-3.52279C5.260274-3.52279 5.037111-3.315567 5.037111-3.108344C5.037111-2.996762 5.084932-2.933001 5.140722-2.893151C5.228394-2.81345 5.467497-2.614197 5.467497-2.223661C5.467497-1.992528 5.244334-1.235367 5.021171-.820922C4.798007-.422416 4.534994-.143462 4.136488-.143462C3.785803-.143462 3.514819-.326775 3.514819-.836862C3.514819-1.044085 3.57061-1.267248 3.682192-1.713574L3.905355-2.606227Z'/>
<path id='eq1-g2-65' d='M2.032379-1.327024C1.613948-.621669 1.207472-.382565 .633624-.3467C.502117-.334745 .406476-.334745 .406476-.119552C.406476-.047821 .466252 0 .549938 0C.765131 0 1.303113-.02391 1.518306-.02391C1.865006-.02391 2.247572 0 2.582316 0C2.654047 0 2.797509 0 2.797509-.227148C2.797509-.334745 2.701868-.3467 2.630137-.3467C2.355168-.37061 2.12802-.466252 2.12802-.753176C2.12802-.920548 2.199751-1.052055 2.355168-1.315068L3.263761-2.82142H6.312329C6.324284-2.713823 6.324284-2.618182 6.336239-2.510585C6.372105-2.199751 6.515567-.956413 6.515567-.729265C6.515567-.37061 5.905853-.3467 5.71457-.3467C5.583064-.3467 5.451557-.3467 5.451557-.131507C5.451557 0 5.559153 0 5.630884 0C5.834122 0 6.073225-.02391 6.276463-.02391H6.957908C7.687173-.02391 8.2132 0 8.225156 0C8.308842 0 8.440349 0 8.440349-.227148C8.440349-.3467 8.332752-.3467 8.153425-.3467C7.49589-.3467 7.483935-.454296 7.44807-.812951L6.718804-8.272976C6.694894-8.51208 6.647073-8.53599 6.515567-8.53599C6.396015-8.53599 6.324284-8.51208 6.216687-8.332752L2.032379-1.327024ZM3.466999-3.16812L5.869988-7.185056L6.276463-3.16812H3.466999Z'/>
</defs>
<g id='eq1-page1'>
<use x='118.0554' y='-4.505261' xlink:href='#eq1-g2-65'/>
<use x='126.830747' y='-2.711998' xlink:href='#eq1-g1-82'/>
<use x='133.258106' y='-2.711998' xlink:href='#eq1-g1-111'/>
<use x='137.351156' y='-2.711998' xlink:href='#eq1-g1-119'/>
<use x='143.642459' y='-2.711998' xlink:href='#eq1-g1-77'/>
<use x='152.624158' y='-2.711998' xlink:href='#eq1-g1-97'/>
<use x='157.122168' y='-2.711998' xlink:href='#eq1-g1-106'/>
<use x='161.006193' y='-2.711998' xlink:href='#eq1-g1-111'/>
<use x='165.099243' y='-2.711998' xlink:href='#eq1-g1-114'/>
<use x='176.295629' y='-4.505261' xlink:href='#eq1-g0-40'/>
<use x='186.258334' y='-4.505261' xlink:href='#eq1-g0-41'/>
<use x='204.855195' y='-4.505261' xlink:href='#eq1-g2-65'/>
<use x='213.630541' y='-9.441447' xlink:href='#eq1-g1-84'/>
<use x='213.630541' y='-1.549746' xlink:href='#eq1-g1-67'/>
<use x='220.229209' y='-1.549746' xlink:href='#eq1-g1-111'/>
<use x='224.322259' y='-1.549746' xlink:href='#eq1-g1-108'/>
<use x='226.944384' y='-1.549746' xlink:href='#eq1-g1-117'/>
<use x='231.847354' y='-1.549746' xlink:href='#eq1-g1-109'/>
<use x='239.33788' y='-1.549746' xlink:href='#eq1-g1-110'/>
<use x='244.476083' y='-1.549746' xlink:href='#eq1-g1-77'/>
<use x='253.457782' y='-1.549746' xlink:href='#eq1-g1-97'/>
<use x='257.955792' y='-1.549746' xlink:href='#eq1-g1-106'/>
<use x='261.839817' y='-1.549746' xlink:href='#eq1-g1-111'/>
<use x='265.932866' y='-1.549746' xlink:href='#eq1-g1-114'/>
</g>
</svg></div><section id="cublasFlowCapturerDataModelExample"><h3><a href="#cublasFlowCapturerDataModelExample">Example: Transform Data Layout in Matrix Multiplication</a></h3><p>Suppose we have a method <code>matmul(A, B, C)</code> that multiplies two matrices <code>A</code> and <code>B</code> and stores the result in <code>C</code>, using column-major storage. In C/C++, data layout is mostly row-major. Since we know a row-major matrix is equivalent in storage to a transposed column-major matrix, we can take a transposed view of this multiplication:</p><div class="m-math"><svg style="width: 8.039em; height: 1.185em;" viewBox="155.433087 -11.378686 77.178693 11.378694">
<title>
\[ C^T = B^T \times A^T \]
</title>
<defs>
<path id='eq2-g0-2' d='M4.65056-3.323537L2.259527-5.702615C2.116065-5.846077 2.092154-5.869988 1.996513-5.869988C1.876961-5.869988 1.75741-5.762391 1.75741-5.630884C1.75741-5.547198 1.78132-5.523288 1.912827-5.391781L4.303861-2.988792L1.912827-.585803C1.78132-.454296 1.75741-.430386 1.75741-.3467C1.75741-.215193 1.876961-.107597 1.996513-.107597C2.092154-.107597 2.116065-.131507 2.259527-.274969L4.638605-2.654047L7.113325-.179328C7.137235-.167372 7.220922-.107597 7.292653-.107597C7.436115-.107597 7.531756-.215193 7.531756-.3467C7.531756-.37061 7.531756-.418431 7.49589-.478207C7.483935-.502117 5.583064-2.379078 4.985305-2.988792L7.173101-5.176588C7.232877-5.248319 7.412204-5.403736 7.47198-5.475467C7.483935-5.499377 7.531756-5.547198 7.531756-5.630884C7.531756-5.762391 7.436115-5.869988 7.292653-5.869988C7.197011-5.869988 7.149191-5.822167 7.017684-5.69066L4.65056-3.323537Z'/>
<path id='eq2-g3-61' d='M8.069738-3.873474C8.237111-3.873474 8.452304-3.873474 8.452304-4.088667C8.452304-4.315816 8.249066-4.315816 8.069738-4.315816H1.028144C.860772-4.315816 .645579-4.315816 .645579-4.100623C.645579-3.873474 .848817-3.873474 1.028144-3.873474H8.069738ZM8.069738-1.649813C8.237111-1.649813 8.452304-1.649813 8.452304-1.865006C8.452304-2.092154 8.249066-2.092154 8.069738-2.092154H1.028144C.860772-2.092154 .645579-2.092154 .645579-1.876961C.645579-1.649813 .848817-1.649813 1.028144-1.649813H8.069738Z'/>
<path id='eq2-g1-84' d='M3.602491-4.821918C3.674222-5.108842 3.682192-5.124782 4.008966-5.124782H4.614695C5.443587-5.124782 5.539228-4.861768 5.539228-4.463263C5.539228-4.26401 5.491407-3.921295 5.483437-3.881445C5.467497-3.793773 5.459527-3.722042 5.459527-3.706102C5.459527-3.602491 5.531258-3.57858 5.579078-3.57858C5.66675-3.57858 5.69863-3.626401 5.72254-3.777833L5.937733-5.276214C5.937733-5.387796 5.842092-5.387796 5.69863-5.387796H1.004234C.804981-5.387796 .789041-5.387796 .73325-5.220423L.247073-3.841594C.231133-3.801743 .207223-3.737983 .207223-3.690162C.207223-3.626401 .263014-3.57858 .326775-3.57858C.414446-3.57858 .430386-3.618431 .478207-3.753923C.932503-5.029141 1.163636-5.124782 2.375093-5.124782H2.685928C2.925031-5.124782 2.933001-5.116812 2.933001-5.053051C2.933001-5.029141 2.901121-4.869738 2.893151-4.837858L1.841096-.653549C1.769365-.350685 1.745455-.263014 .916563-.263014C.661519-.263014 .581818-.263014 .581818-.111582C.581818-.103611 .581818 0 .71731 0C.932503 0 1.482441-.02391 1.697634-.02391H2.375093C2.598257-.02391 3.156164 0 3.379328 0C3.443088 0 3.56264 0 3.56264-.151432C3.56264-.263014 3.474969-.263014 3.259776-.263014C3.068493-.263014 3.004732-.263014 2.797509-.278954C2.542466-.302864 2.510585-.334745 2.510585-.438356C2.510585-.470237 2.518555-.502117 2.542466-.581818L3.602491-4.821918Z'/>
<path id='eq2-g2-65' d='M2.032379-1.327024C1.613948-.621669 1.207472-.382565 .633624-.3467C.502117-.334745 .406476-.334745 .406476-.119552C.406476-.047821 .466252 0 .549938 0C.765131 0 1.303113-.02391 1.518306-.02391C1.865006-.02391 2.247572 0 2.582316 0C2.654047 0 2.797509 0 2.797509-.227148C2.797509-.334745 2.701868-.3467 2.630137-.3467C2.355168-.37061 2.12802-.466252 2.12802-.753176C2.12802-.920548 2.199751-1.052055 2.355168-1.315068L3.263761-2.82142H6.312329C6.324284-2.713823 6.324284-2.618182 6.336239-2.510585C6.372105-2.199751 6.515567-.956413 6.515567-.729265C6.515567-.37061 5.905853-.3467 5.71457-.3467C5.583064-.3467 5.451557-.3467 5.451557-.131507C5.451557 0 5.559153 0 5.630884 0C5.834122 0 6.073225-.02391 6.276463-.02391H6.957908C7.687173-.02391 8.2132 0 8.225156 0C8.308842 0 8.440349 0 8.440349-.227148C8.440349-.3467 8.332752-.3467 8.153425-.3467C7.49589-.3467 7.483935-.454296 7.44807-.812951L6.718804-8.272976C6.694894-8.51208 6.647073-8.53599 6.515567-8.53599C6.396015-8.53599 6.324284-8.51208 6.216687-8.332752L2.032379-1.327024ZM3.466999-3.16812L5.869988-7.185056L6.276463-3.16812H3.466999Z'/>
<path id='eq2-g2-66' d='M4.375592-7.352428C4.483188-7.79477 4.531009-7.81868 4.99726-7.81868H6.551432C7.902366-7.81868 7.902366-6.670984 7.902366-6.563387C7.902366-5.595019 6.933998-4.363636 5.355915-4.363636H3.634371L4.375592-7.352428ZM6.396015-4.267995C7.699128-4.507098 8.88269-5.415691 8.88269-6.515567C8.88269-7.44807 8.057783-8.16538 6.706849-8.16538H2.86924C2.642092-8.16538 2.534496-8.16538 2.534496-7.938232C2.534496-7.81868 2.642092-7.81868 2.82142-7.81868C3.550685-7.81868 3.550685-7.723039 3.550685-7.591532C3.550685-7.567621 3.550685-7.49589 3.502864-7.316563L1.888917-.884682C1.78132-.466252 1.75741-.3467 .920548-.3467C.6934-.3467 .573848-.3467 .573848-.131507C.573848 0 .645579 0 .884682 0H4.985305C6.814446 0 8.225156-1.3868 8.225156-2.594271C8.225156-3.574595 7.364384-4.172354 6.396015-4.267995ZM4.698381-.3467H3.084433C2.917061-.3467 2.893151-.3467 2.82142-.358655C2.689913-.37061 2.677958-.394521 2.677958-.490162C2.677958-.573848 2.701868-.645579 2.725778-.753176L3.56264-4.124533H5.810212C7.220922-4.124533 7.220922-2.809465 7.220922-2.713823C7.220922-1.566127 6.180822-.3467 4.698381-.3467Z'/>
<path id='eq2-g2-67' d='M8.930511-8.308842C8.930511-8.416438 8.846824-8.416438 8.822914-8.416438S8.751183-8.416438 8.655542-8.296887L7.830635-7.292653C7.412204-8.009963 6.75467-8.416438 5.858032-8.416438C3.275716-8.416438 .597758-5.798257 .597758-2.988792C.597758-.992279 1.996513 .251059 3.741968 .251059C4.698381 .251059 5.535243-.155417 6.228643-.74122C7.268742-1.613948 7.579577-2.773599 7.579577-2.86924C7.579577-2.976837 7.483935-2.976837 7.44807-2.976837C7.340473-2.976837 7.328518-2.905106 7.304608-2.857285C6.75467-.992279 5.140722-.095641 3.945205-.095641C2.677958-.095641 1.578082-.908593 1.578082-2.606227C1.578082-2.988792 1.697634-5.068991 3.048568-6.635118C3.706102-7.400249 4.829888-8.069738 5.965629-8.069738C7.280697-8.069738 7.866501-6.981818 7.866501-5.762391C7.866501-5.451557 7.830635-5.188543 7.830635-5.140722C7.830635-5.033126 7.950187-5.033126 7.986052-5.033126C8.117559-5.033126 8.129514-5.045081 8.177335-5.260274L8.930511-8.308842Z'/>
</defs>
<g id='eq2-page1'>
<use x='155.433087' y='-.996264' xlink:href='#eq2-g2-67'/>
<use x='164.666699' y='-5.93245' xlink:href='#eq2-g1-84'/>
<use x='174.592018' y='-.996264' xlink:href='#eq2-g3-61'/>
<use x='187.017499' y='-.996264' xlink:href='#eq2-g2-66'/>
<use x='196.51376' y='-5.93245' xlink:href='#eq2-g1-84'/>
<use x='205.774914' y='-.996264' xlink:href='#eq2-g0-2'/>
<use x='217.730074' y='-.996264' xlink:href='#eq2-g2-65'/>
<use x='226.505421' y='-5.93245' xlink:href='#eq2-g1-84'/>
</g>
</svg></div><p>If the given matrices <code>A</code>, <code>B</code>, and <code>C</code> are on row-major layout, calling <code>matmul(A, B, C)</code> is equivalent to the above transposed version. The function stores the result of transposed <code>C</code> in column-major storage which in turns translates to row-major layout of <code>C</code> &ndash; <em>our desired solution</em>.</p></section></section><section id="cublasFlowCapturerLevel-1"><h2><a href="#cublasFlowCapturerLevel-1">Use Level-1 Methods</a></h2><p>We currently support the following level-1 methods:</p><ul><li><a href="classtf_1_1cublasFlowCapturer.html#ab1357bb1728f5fe526acef8afee7111e" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />amax</a> finds the min element index of the max absolute magnitude in a vector</li><li><a href="classtf_1_1cublasFlowCapturer.html#a7a6485c37d50b9c79205f728ab380929" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />amin</a> finds the min element index of the min magnitude in a vector</li><li><a href="classtf_1_1cublasFlowCapturer.html#ab7672cee3d219ccc75c48b62cf1d1bad" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />asum</a> computes the sum of absolute values of elements over a vector</li><li><a href="classtf_1_1cublasFlowCapturer.html#a56f8649d43652597da1c9b0a5f88b0ee" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />axpy</a> multiplies a vector by a scalar and adds it to another vector</li><li><a href="classtf_1_1cudaFlowCapturerBase.html#a9fd8983c782f841bba6b10de39becdf6" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />copy</a> copies a vector into another vector</li><li><a href="classtf_1_1cublasFlowCapturer.html#afdfa01d9f277051e44d7ed9663555b52" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />dot</a> computes the dot product of two vectors</li><li><a href="classtf_1_1cublasFlowCapturer.html#a8000fc6dbbb6f6f5a033f1b365e80d38" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />nrm2</a> computes the Euclidean norm of a vector</li><li><a href="classtf_1_1cublasFlowCapturer.html#adb8f5d3137f5ccb3469a5bdde454a8bf" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />scal</a> multiples a vector by a scalar</li><li><a href="classtf_1_1cublasFlowCapturer.html#a32451b05fd7eb937ce8e807b5d5abe1f" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />swap</a> interchanges the elements of two vectors</li></ul><p>Our level-1 methods capture the native <a href="https://docs.nvidia.com/cuda/cublas/index.html#cublas-level-1-function-reference">cublas level-1 calls</a> with internal stream(s) optimized for maximum concurrency. The two scalars, <code>alpha</code> and <code>beta</code>, and input and output matrices must sit in GPU memory space.</p></section><section id="cublasFlowCapturerLeve2-1"><h2><a href="#cublasFlowCapturerLeve2-1">Use Level-2 Methods</a></h2><p>We currently support the following level-2 methods:</p><ul><li><a href="classtf_1_1cublasFlowCapturer.html#a72185bf94321948b5b3657cc9c52ad0a" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />gemv</a> performs general matrix-vector multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#a3a492f3f22949e0e6b1058113eb475d0" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_gemv</a> performs general matrix-vector multiplication on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#aed19fb69f2242f4ac6429f94d7776727" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />symv</a> performs symmetric matrix-vector multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#a128ac1083f1dd05690998f5dac01959e" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_symv</a> performs symmetric matrix-vector multiplication on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a6765f845c7b95daefa197fdc2a1b426d" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />syr</a> performs symmetric rank-1 update</li><li><a href="classtf_1_1cublasFlowCapturer.html#afd79fe59e463b91feb2cbb94079c7c8c" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_syr</a> performs symmetric rank-1 update on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a46443a7e6c36f2a0d655041f6227b544" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />syr2</a> performs symmetric rank-2 update</li><li><a href="classtf_1_1cublasFlowCapturer.html#ac3ebc265f36b4c1205360a055f197873" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_syr2</a> performs symmetric rank-2 update on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#af0ff6efaa01bffbd20d2760b6f82bcb1" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />trmv</a> performs triangular matrix-vector multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#adb57fd25e55f0b4e2f4f0045a169f8d9" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_trmv</a> performs triangular matrix-vector multiplication on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a5f10c25901bff8c626235dfdd6d10b57" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />trsv</a> solves triangular linear system with a single right-hand-side</li><li><a href="classtf_1_1cublasFlowCapturer.html#a27ae640e916e5f3d74886c57fe19342a" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_trsv</a> solves triangular linear system with a single right-hand-side on row-major layout</li></ul><p>Our level-2 methods capture the native <a href="https://docs.nvidia.com/cuda/cublas/index.html#cublas-level-2-function-reference">cublas level-2 calls</a> with internal stream(s) optimized for maximum concurrency. The two scalars, <code>alpha</code> and <code>beta</code>, and input and output matrices must sit in GPU memory space.</p><section id="cublasFlowCapturerLevel2Example"><h3><a href="#cublasFlowCapturerLevel2Example">Example: Solve a Triangular Linear System</a></h3><p>The following program solves a triangular linear system on row-major layout using <a href="classtf_1_1cublasFlowCapturer.html#a27ae640e916e5f3d74886c57fe19342a" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_trsv</a>:</p><pre class="m-code"><span class="cp">#include</span> <span class="cpf">&lt;taskflow/cublasflow.hpp&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="kt">int</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">hA</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1">// x1</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="c1">// x1 + x2</span>
    <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span>   <span class="c1">// x1 + x2 + x3</span>
  <span class="p">};</span>

  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">hB</span> <span class="o">=</span> <span class="p">{</span>
    <span class="mi">5</span><span class="p">,</span>        <span class="c1">// x1           = 5</span>
    <span class="mi">4</span><span class="p">,</span>        <span class="c1">// x1 + x2      = 4</span>
    <span class="mi">7</span>         <span class="c1">// x1 + x2 + x3 = 7</span>
  <span class="p">};</span>

  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">r</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span> <span class="n">taskflow</span><span class="p">(</span><span class="s">&quot;Ax = b&quot;</span><span class="p">);</span>
  <span class="n">tf</span><span class="o">::</span><span class="n">Executor</span> <span class="n">executor</span><span class="p">;</span>

  <span class="kt">float</span><span class="o">*</span> <span class="n">dA</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">hA</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>
  <span class="kt">float</span><span class="o">*</span> <span class="n">dB</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">hB</span><span class="p">.</span><span class="n">size</span><span class="p">());</span>

  <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">cudaFlowCapturer</span><span class="o">&amp;</span> <span class="n">capturer</span><span class="p">){</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">blas</span> <span class="o">=</span> <span class="n">capturer</span><span class="p">.</span><span class="n">make_capturer</span><span class="o">&lt;</span><span class="n">tf</span><span class="o">::</span><span class="n">cublasFlowCapturer</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">h2dA</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="n">dA</span><span class="p">,</span> <span class="n">hA</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">hA</span><span class="p">.</span><span class="n">size</span><span class="p">()).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;copy A&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">h2dB</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="n">dB</span><span class="p">,</span> <span class="n">hB</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">hB</span><span class="p">.</span><span class="n">size</span><span class="p">()).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;copy B&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">trsv</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">c_trsv</span><span class="p">(</span>
      <span class="n">CUBLAS_FILL_MODE_LOWER</span><span class="p">,</span> <span class="n">CUBLAS_OP_N</span><span class="p">,</span> <span class="n">CUBLAS_DIAG_UNIT</span><span class="p">,</span> 
      <span class="n">N</span><span class="p">,</span> <span class="n">dA</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="mi">1</span>
    <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;trsv&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">d2h</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">dB</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">size</span><span class="p">()).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;copy result&quot;</span><span class="p">);</span>

    <span class="n">trsv</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">h2dA</span><span class="p">,</span> <span class="n">h2dB</span><span class="p">)</span>
        <span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">d2h</span><span class="p">);</span>
  <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cublasFlow&quot;</span><span class="p">);</span>

  <span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span>
  
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;solution of the linear system: </span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">r</span><span class="p">.</span><span class="n">size</span><span class="p">();</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;x&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">i</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></pre><p>The program uses one cudaFlow task that spawns a capturer of (1) two copy tasks, <code>h2dA</code> and <code>h2dB</code>, to copy the triangular matrix <code>A</code> and the solution vector <code>b</code>, (2) one kernel task <code>trsv</code> to solve the triangular linear system storing the result in <code>dB</code>, and (3) one copy task <code>d2h</code> to copy the solution in <code>dB</code> to <code>r</code>.</p><div class="m-graph"><svg style="width: 34.375rem; height: 12.438rem;" viewBox="0.00 0.00 550.50 199.00">
<g transform="scale(1 1) rotate(0) translate(4 195)">
<title>Taskflow</title>
<g class="m-cluster">
<title>cluster_p0x7ffea58711b0</title>
<polygon points="8,-8 8,-183 534.5,-183 534.5,-8 8,-8"/>
<text text-anchor="middle" x="271.25" y="-166.2">Taskflow: Ax = b</text>
</g>
<g class="m-cluster">
<title>cluster_p0x18c01a0</title>
<polygon points="16,-16 16,-149 526.5,-149 526.5,-16 16,-16"/>
<text text-anchor="middle" x="271.25" y="-132.2">cudaFlow: cublasFlow</text>
</g>
<g class="m-node">
<title>p0x18c01a0</title>
<polygon points="518.5,-87 515.5,-91 494.5,-91 491.5,-87 420.5,-87 420.5,-51 518.5,-51 518.5,-87"/>
<text text-anchor="middle" x="469.5" y="-65.2">cublasFlow</text>
</g>
<g class="m-node m-flat">
<title>p0x7f7e06617130</title>
<ellipse cx="70.67" cy="-97" rx="45.92" ry="18.27"/>
<text text-anchor="middle" x="70.67" y="-93.2">copy A</text>
</g>
<g class="m-node m-flat">
<title>p0x7f7e066172d0</title>
<ellipse cx="183.74" cy="-69" rx="30.31" ry="18.27"/>
<text text-anchor="middle" x="183.74" y="-65.2">trsv</text>
</g>
<g class="m-edge">
<title>p0x7f7e06617130&#45;&gt;p0x7f7e066172d0</title>
<path d="M109.89,-87.36C121.45,-84.45 134.11,-81.26 145.59,-78.37"/>
<polygon points="146.47,-81.75 155.32,-75.91 144.76,-74.96 146.47,-81.75"/>
</g>
<g class="m-node m-flat">
<title>p0x7f7e066173d0</title>
<ellipse cx="317.32" cy="-69" rx="67.35" ry="18.27"/>
<text text-anchor="middle" x="317.32" y="-65.2">copy result</text>
</g>
<g class="m-edge">
<title>p0x7f7e066172d0&#45;&gt;p0x7f7e066173d0</title>
<path d="M214.27,-69C222.04,-69 230.78,-69 239.8,-69"/>
<polygon points="240.06,-72.5 250.06,-69 240.06,-65.5 240.06,-72.5"/>
</g>
<g class="m-node m-flat">
<title>p0x7f7e06617200</title>
<ellipse cx="70.67" cy="-42" rx="46.84" ry="18.27"/>
<text text-anchor="middle" x="70.67" y="-38.2">copy B</text>
</g>
<g class="m-edge">
<title>p0x7f7e06617200&#45;&gt;p0x7f7e066172d0</title>
<path d="M110.83,-51.52C122.02,-54.24 134.18,-57.2 145.27,-59.89"/>
<polygon points="144.55,-63.32 155.09,-62.28 146.2,-56.51 144.55,-63.32"/>
</g>
<g class="m-edge">
<title>p0x7f7e066173d0&#45;&gt;p0x18c01a0</title>
<path d="M384.63,-69C393.12,-69 401.76,-69 410.12,-69"/>
<polygon points="410.13,-72.5 420.13,-69 410.13,-65.5 410.13,-72.5"/>
</g>
</g>
</svg>
</div></section></section><section id="cublasFlowCapturerLevel-3"><h2><a href="#cublasFlowCapturerLevel-3">Use Level-3 Methods</a></h2><p>We currently support the following level-3 methods:</p><ul><li><a href="classtf_1_1cublasFlowCapturer.html#a30b437e511b5719f6253d3a9cf0a992c" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />geam</a> performs matrix-matrix addition/transposition</li><li><a href="classtf_1_1cublasFlowCapturer.html#a756dc6637521ef4f2249711effd1d0f5" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_geam</a> performs matrix-matrix addition/transposition on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a8adbe06476f146b27bb00ba6054e5879" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />gemm</a> performs general matrix-matrix multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#aecfd3b623b457d277dca40c2e1b3c1c0" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_gemm</a> performs general matrix-matrix multiplication on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a56af0e8ed80e5626fe2f594608afa405" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />gemm_batched</a> performs batched general matrix-matrix multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#aa9415957e3e48df65dc3baad86d05b38" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_gemm_batched</a> performs batched general matrix-matrix multiplication on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a36ecdcea0f24575187e44374e583df2e" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />gemm_sbatched</a> performs batched general matrix-matrix multiplication with strided memory access</li><li><a href="classtf_1_1cublasFlowCapturer.html#ae57c53a1a07c0b4f73d90bf21fee4e1c" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_gemm_sbatched</a> performs batched general matrix-matrix multiplication with strided memory access on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a9d0eb2c37b48120bd40b1f725b507c42" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />symm</a> performs symmetric matrix-matrix multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#a23a4636954cfdb34835b0d7a275fe4a8" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_symm</a> performs symmetric matrix-matrix multiplicaiton on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#aade5e9a358b7f4195367ef460921a236" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />syrk</a> performs symmetric rank-k update</li><li><a href="classtf_1_1cublasFlowCapturer.html#af9b146e7a3d4afb6658fa5fd8a860527" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_syrk</a> performs symmetric rank-k update on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a45f110bd529b49531e3c83458a8990ac" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />syr2k</a> performs symmetric rank-2k update</li><li><a href="classtf_1_1cublasFlowCapturer.html#ab2f1c253b6808ac011b7ea9d2fc82e58" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_syr2k</a> performs symmetric rank-2k update on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#af5461904ac5714c5cc7eb7bbd8e2883e" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />syrkx</a> performs a variantion of symmetric rank-k update</li><li><a href="classtf_1_1cublasFlowCapturer.html#a18ef82f489aaaa80d3d3c7cde6750729" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_syrkx</a> performs a variantion of symmetric rank-k update on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#a11e49f148b84ebc95ddeb5f4c3af78d8" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />trmm</a> performs triangular matrix-matrix multiplication</li><li><a href="classtf_1_1cublasFlowCapturer.html#ad9118a1eff03514a0c9f75e21e76fe35" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_trmm</a> performs triangular matrix-matrix multiplication on row-major layout</li><li><a href="classtf_1_1cublasFlowCapturer.html#aa8cc2fcfeb3ffbc1146dda358b2b8188" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />trsm</a> solves a triangular linear system with multiple right-hand-sides</li><li><a href="classtf_1_1cublasFlowCapturer.html#a7a0282cc21707315d347b5e4d8d3f25e" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_trsm</a> solves a triangular linear system with multiple right-hand-sides on row-major layout</li></ul><p>Our level-3 methods capture the native <a href="https://docs.nvidia.com/cuda/cublas/index.html#cublas-level-2-function-reference">cublas level-3 calls</a> and <a href="https://docs.nvidia.com/cuda/cublas/index.html#blas-like-extension">cublas-extension calls</a> with internal stream(s) optimized for maximum concurrency. The two scalars, <code>alpha</code> and <code>beta</code>, and input and output matrices must sit in GPU memory space.</p><section id="cublasFlowCapturerLevel3Example"><h3><a href="#cublasFlowCapturerLevel3Example">Example: Perform General Matrix-Matrix Multiplication</a></h3><p>The following program performs general matrix multiplication on row-major layout using <a href="classtf_1_1cublasFlowCapturer.html#aecfd3b623b457d277dca40c2e1b3c1c0" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />c_gemm</a>:</p><pre class="m-code"><span class="cp">#include</span> <span class="cpf">&lt;taskflow/cublasflow.hpp&gt;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>

  <span class="k">const</span> <span class="kt">int</span> <span class="n">M</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>

  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">hA</span> <span class="o">=</span> <span class="p">{</span>      <span class="c1">// M x K matrix</span>
    <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> 
    <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span>
  <span class="p">};</span>

  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">hB</span> <span class="o">=</span> <span class="p">{</span>      <span class="c1">// K x N matrix</span>
    <span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span>
    <span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span>
    <span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span>
  <span class="p">};</span>

  <span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">golden</span> <span class="o">=</span> <span class="p">{</span>  <span class="c1">// M x N matrix</span>
    <span class="mi">548</span><span class="p">,</span> <span class="mi">584</span><span class="p">,</span> <span class="mi">620</span><span class="p">,</span> <span class="mi">656</span><span class="p">,</span>
    <span class="mi">683</span><span class="p">,</span> <span class="mi">728</span><span class="p">,</span> <span class="mi">773</span><span class="p">,</span> <span class="mi">818</span> 
  <span class="p">};</span>

  <span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span> <span class="n">hC</span><span class="p">(</span><span class="n">M</span><span class="o">*</span><span class="n">N</span><span class="p">);</span>
    
  <span class="kt">float</span> <span class="o">*</span><span class="n">dA</span><span class="p">,</span> <span class="o">*</span><span class="n">dB</span><span class="p">,</span> <span class="o">*</span><span class="n">dC</span><span class="p">,</span> <span class="o">*</span><span class="n">dAlpha</span><span class="p">,</span> <span class="o">*</span><span class="n">dBeta</span><span class="p">;</span>

  <span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span> <span class="n">taskflow</span><span class="p">(</span><span class="s">&quot;Matrix Multiplication&quot;</span><span class="p">);</span>
  <span class="n">tf</span><span class="o">::</span><span class="n">Executor</span> <span class="n">executor</span><span class="p">;</span>

  <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">malloc_dA</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
    <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span> <span class="n">dA</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">hA</span><span class="p">.</span><span class="n">size</span><span class="p">());</span> <span class="p">}</span>
  <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;malloc_dA&quot;</span><span class="p">);</span>      <span class="c1">// allocate GPU memory for dA</span>
  
  <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">malloc_dB</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
    <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span> <span class="n">dB</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">hB</span><span class="p">.</span><span class="n">size</span><span class="p">());</span> <span class="p">}</span>
  <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;malloc_dB&quot;</span><span class="p">);</span>      <span class="c1">// allocate GPU memory for dB</span>
  
  <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">malloc_dC</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
    <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span> <span class="n">dC</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="n">hC</span><span class="p">.</span><span class="n">size</span><span class="p">());</span> <span class="p">}</span>
  <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;malloc_dC&quot;</span><span class="p">);</span>      <span class="c1">// allocate GPU memory for dC</span>
  
  <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">malloc_dAlpha</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
    <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span> <span class="n">dAlpha</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;malloc_dAlpha&quot;</span><span class="p">);</span>  <span class="c1">// allocate GPU memory for scalar alpha</span>
  
  <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">malloc_dBeta</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
    <span class="p">[</span><span class="o">&amp;</span><span class="p">](){</span> <span class="n">dBeta</span> <span class="o">=</span> <span class="n">tf</span><span class="o">::</span><span class="n">cuda_malloc_device</span><span class="o">&lt;</span><span class="kt">float</span><span class="o">&gt;</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span> <span class="p">}</span>
  <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;malloc_dBeta&quot;</span><span class="p">);</span>   <span class="c1">// allocate GPU memory for scalar beta</span>

  <span class="n">tf</span><span class="o">::</span><span class="n">Task</span> <span class="n">cublasFlow</span> <span class="o">=</span> <span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">cudaFlowCapturer</span><span class="o">&amp;</span> <span class="n">capturer</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">blas</span>  <span class="o">=</span> <span class="n">capturer</span><span class="p">.</span><span class="n">make_capturer</span><span class="o">&lt;</span><span class="n">tf</span><span class="o">::</span><span class="n">cublasFlowCapturer</span><span class="o">&gt;</span><span class="p">();</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">single_task</span><span class="p">([</span><span class="o">=</span><span class="p">]</span> <span class="n">__device__</span> <span class="p">()</span> <span class="p">{</span> <span class="o">*</span><span class="n">dAlpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">})</span>
                              <span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;alpha=1&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">beta</span>  <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">single_task</span><span class="p">([</span><span class="o">=</span><span class="p">]</span> <span class="n">__device__</span> <span class="p">()</span> <span class="p">{</span> <span class="o">*</span><span class="n">dBeta</span>  <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="p">})</span>
                              <span class="p">.</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;beta=0&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">copyA</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="n">dA</span><span class="p">,</span> <span class="n">hA</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">hA</span><span class="p">.</span><span class="n">size</span><span class="p">()).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;copyA&quot;</span><span class="p">);</span> 
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">copyB</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="n">dB</span><span class="p">,</span> <span class="n">hB</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">hB</span><span class="p">.</span><span class="n">size</span><span class="p">()).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;copyB&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">gemm</span>  <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">c_gemm</span><span class="p">(</span><span class="n">CUBLAS_OP_N</span><span class="p">,</span> <span class="n">CUBLAS_OP_N</span><span class="p">,</span>
      <span class="n">M</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dAlpha</span><span class="p">,</span> <span class="n">dA</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">dB</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">dBeta</span><span class="p">,</span> <span class="n">dC</span><span class="p">,</span> <span class="n">N</span>
    <span class="p">).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;C = alpha * A * B + beta * C&quot;</span><span class="p">);</span>
    <span class="n">tf</span><span class="o">::</span><span class="n">cudaTask</span> <span class="n">copyC</span> <span class="o">=</span> <span class="n">blas</span><span class="o">-&gt;</span><span class="n">copy</span><span class="p">(</span><span class="n">hC</span><span class="p">.</span><span class="n">data</span><span class="p">(),</span> <span class="n">dC</span><span class="p">,</span> <span class="n">hC</span><span class="p">.</span><span class="n">size</span><span class="p">()).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;copyC&quot;</span><span class="p">);</span>

    <span class="n">gemm</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">copyA</span><span class="p">,</span> <span class="n">copyB</span><span class="p">)</span>
        <span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">copyC</span><span class="p">);</span>
  <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;cublasFlow&quot;</span><span class="p">);</span>

  <span class="n">cublasFlow</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span>  <span class="c1">// cublasFlow runs after GPU memory operations</span>
    <span class="n">malloc_dA</span><span class="p">,</span> <span class="n">malloc_dB</span><span class="p">,</span> <span class="n">malloc_dC</span><span class="p">,</span> <span class="n">malloc_dAlpha</span><span class="p">,</span> <span class="n">malloc_dBeta</span>
  <span class="p">);</span>

  <span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">wait</span><span class="p">();</span>
  
  <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Matrix C:</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">m</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">m</span><span class="o">&lt;</span><span class="n">M</span><span class="p">;</span> <span class="n">m</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span><span class="n">N</span><span class="p">;</span> <span class="n">n</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">hC</span><span class="p">[</span><span class="n">m</span><span class="o">*</span><span class="n">N</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39; &#39;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="sc">&#39;\n&#39;</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></pre><p>The program uses five static tasks to allocate GPU memory for <code>dA</code>, <code>dB</code>, <code>dC</code>, <code>dAlpha</code>, and <code>dBeta</code>, in parallel such that the expensive GPU memory operations can overlap with each other as much as possible. The <code>cublasFlow</code> task spawns a cublasFlow capturer of (1) one single kernel task <code>alpha</code> to set <code>dAlpha</code> to 1, (2) one single kernel task <code>beta</code> to set <code>dBeta</code> to 0, (3) two copy tasks, <code>copyA</code> and <code>copyB</code>, to copy data from CPU to GPU, (4) one kernel task <code>gemm</code> to perform <code>dC = dA * dB</code>, and (5) one copy task <code>copyC</code> to copy the result from GPU to CPU.</p><div class="m-graph"><svg style="width: 52.375rem; height: 35.125rem;" viewBox="0.00 0.00 837.58 562.00">
<g transform="scale(1 1) rotate(0) translate(4 558)">
<title>Taskflow</title>
<g class="m-cluster">
<title>cluster_p0x7fff9680d710</title>
<polygon points="8,-8 8,-546 821.58,-546 821.58,-8 8,-8"/>
<text text-anchor="middle" x="414.79" y="-529.2">Taskflow: Matrix Multiplication</text>
</g>
<g class="m-cluster">
<title>cluster_p0xe0e598</title>
<polygon points="16,-60 16,-303 813.58,-303 813.58,-60 16,-60"/>
<text text-anchor="middle" x="414.79" y="-286.2">cudaFlow: cublasFlow</text>
</g>
<g class="m-node m-flat">
<title>p0xe0e200</title>
<ellipse cx="584.61" cy="-494" rx="65.11" ry="18.27"/>
<text text-anchor="middle" x="584.61" y="-490.2">malloc_dA</text>
</g>
<g class="m-node">
<title>p0xe0e598</title>
<polygon points="805.58,-269 802.58,-273 781.58,-273 778.58,-269 707.58,-269 707.58,-233 805.58,-233 805.58,-269"/>
<text text-anchor="middle" x="756.58" y="-247.2">cublasFlow</text>
</g>
<g class="m-edge">
<title>p0xe0e200&#45;&gt;p0xe0e598</title>
<path d="M640.04,-484.25C651.52,-480.14 662.8,-474.3 671.58,-466 725.68,-414.94 745.49,-324.89 752.29,-279.24"/>
<polygon points="755.79,-279.54 753.69,-269.16 748.85,-278.58 755.79,-279.54"/>
</g>
<g class="m-node m-flat">
<title>p0xe0e2b8</title>
<ellipse cx="584.61" cy="-439" rx="65.11" ry="18.27"/>
<text text-anchor="middle" x="584.61" y="-435.2">malloc_dB</text>
</g>
<g class="m-edge">
<title>p0xe0e2b8&#45;&gt;p0xe0e598</title>
<path d="M638.93,-428.67C650.59,-424.58 662.23,-418.9 671.58,-411 713.26,-375.82 737.07,-314.64 748.06,-278.99"/>
<polygon points="751.47,-279.81 750.94,-269.23 744.75,-277.83 751.47,-279.81"/>
</g>
<g class="m-node m-flat">
<title>p0xe0e370</title>
<ellipse cx="584.61" cy="-384" rx="65.52" ry="18.27"/>
<text text-anchor="middle" x="584.61" y="-380.2">malloc_dC</text>
</g>
<g class="m-edge">
<title>p0xe0e370&#45;&gt;p0xe0e598</title>
<path d="M637,-372.63C648.99,-368.56 661.26,-363.15 671.58,-356 701.07,-335.59 725.41,-301.87 740.17,-278.16"/>
<polygon points="743.35,-279.67 745.53,-269.3 737.36,-276.05 743.35,-279.67"/>
</g>
<g class="m-node m-flat">
<title>p0xe0e428</title>
<ellipse cx="584.61" cy="-329" rx="86.95" ry="18.27"/>
<text text-anchor="middle" x="584.61" y="-325.2">malloc_dAlpha</text>
</g>
<g class="m-edge">
<title>p0xe0e428&#45;&gt;p0xe0e598</title>
<path d="M647.07,-315.99C655.46,-313.43 663.84,-310.45 671.58,-307 690.36,-298.63 709.56,-286.18 724.86,-275.14"/>
<polygon points="726.96,-277.94 732.93,-269.18 722.8,-272.3 726.96,-277.94"/>
</g>
<g class="m-node m-flat">
<title>p0xe0e4e0</title>
<ellipse cx="584.61" cy="-34" rx="81.13" ry="18.27"/>
<text text-anchor="middle" x="584.61" y="-30.2">malloc_dBeta</text>
</g>
<g class="m-edge">
<title>p0xe0e4e0&#45;&gt;p0xe0e598</title>
<path d="M652.09,-44.27C659.15,-47.26 665.85,-51.09 671.58,-56 722.73,-99.72 743.65,-180.23 751.44,-222.84"/>
<polygon points="748.01,-223.55 753.15,-232.81 754.91,-222.36 748.01,-223.55"/>
</g>
<g class="m-node m-flat">
<title>p0x7f4711d8d260</title>
<ellipse cx="76.33" cy="-251" rx="52.15" ry="18.27"/>
<text text-anchor="middle" x="76.33" y="-247.2">alpha=1</text>
</g>
<g class="m-node m-flat">
<title>p0x7f4711d8d510</title>
<ellipse cx="313.14" cy="-196" rx="148.48" ry="18.27"/>
<text text-anchor="middle" x="313.14" y="-192.2">C = alpha * A * B + beta * C</text>
</g>
<g class="m-edge">
<title>p0x7f4711d8d260&#45;&gt;p0x7f4711d8d510</title>
<path d="M120.4,-240.91C151.75,-233.57 195.13,-223.41 232.7,-214.61"/>
<polygon points="233.68,-217.97 242.61,-212.29 232.08,-211.16 233.68,-217.97"/>
</g>
<g class="m-node m-flat">
<title>p0x7f4711d8d620</title>
<ellipse cx="584.61" cy="-224" rx="43.68" ry="18.27"/>
<text text-anchor="middle" x="584.61" y="-220.2">copyC</text>
</g>
<g class="m-edge">
<title>p0x7f4711d8d510&#45;&gt;p0x7f4711d8d620</title>
<path d="M427.64,-207.79C463.8,-211.55 502.04,-215.52 531.61,-218.6"/>
<polygon points="531.39,-222.09 541.69,-219.64 532.11,-215.13 531.39,-222.09"/>
</g>
<g class="m-node m-flat">
<title>p0x7f4711d8d310</title>
<ellipse cx="76.33" cy="-196" rx="46.84" ry="18.27"/>
<text text-anchor="middle" x="76.33" y="-192.2">beta=0</text>
</g>
<g class="m-edge">
<title>p0x7f4711d8d310&#45;&gt;p0x7f4711d8d510</title>
<path d="M123.16,-196C132.66,-196 143.18,-196 154.24,-196"/>
<polygon points="154.54,-199.5 164.54,-196 154.54,-192.5 154.54,-199.5"/>
</g>
<g class="m-node m-flat">
<title>p0x7f4711d8d3c0</title>
<ellipse cx="76.33" cy="-141" rx="43.68" ry="18.27"/>
<text text-anchor="middle" x="76.33" y="-137.2">copyA</text>
</g>
<g class="m-edge">
<title>p0x7f4711d8d3c0&#45;&gt;p0x7f4711d8d510</title>
<path d="M115.05,-149.84C146.73,-157.25 193.04,-168.1 232.82,-177.42"/>
<polygon points="232.25,-180.88 242.78,-179.75 233.84,-174.06 232.25,-180.88"/>
</g>
<g class="m-node m-flat">
<title>p0x7f4711d8d480</title>
<ellipse cx="76.33" cy="-86" rx="43.68" ry="18.27"/>
<text text-anchor="middle" x="76.33" y="-82.2">copyB</text>
</g>
<g class="m-edge">
<title>p0x7f4711d8d480&#45;&gt;p0x7f4711d8d510</title>
<path d="M106.12,-99.49C145.73,-118.04 217.51,-151.67 265.01,-173.92"/>
<polygon points="263.63,-177.14 274.17,-178.21 266.6,-170.8 263.63,-177.14"/>
</g>
<g class="m-edge">
<title>p0x7f4711d8d620&#45;&gt;p0xe0e598</title>
<path d="M625.89,-230.4C647.28,-233.8 673.95,-238.03 697.54,-241.78"/>
<polygon points="697,-245.24 707.43,-243.35 698.1,-238.33 697,-245.24"/>
</g>
</g>
</svg>
</div></section></section><section id="cublasFlowCapturerExtension"><h2><a href="#cublasFlowCapturerExtension">Include Other cuBLAS Methods</a></h2><p>We do not include all the cuBLAS functions but users can easily make extension. <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> is derived from <a href="classtf_1_1cudaFlowCapturerBase.html" class="m-doc">tf::<wbr />cudaFlowCapturerBase</a> and is created from a factory interface <a href="classtf_1_1cudaFlowCapturer.html#a49dd9727aeb5bccd7d826c6b11a6882d" class="m-doc">tf::<wbr />cudaFlowCapturer::<wbr />make_capturer</a>. You can use all the base methods <a href="classtf_1_1cudaFlowCapturerBase.html#afa4e61e31e202f222e0f508ce3d159fc" class="m-doc">tf::<wbr />cudaFlowCapturerBase::<wbr />on</a> to capture other cuBLAS functions that are currently not available in <a href="classtf_1_1cudaFlowCapturer.html" class="m-doc">tf::<wbr />cudaFlowCapturer</a>. The following example captures the Hermitian rank-k update using <code>cublasCherkx</code>.</p><pre class="m-code"><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">cudaFlowCapturer</span><span class="o">&amp;</span> <span class="n">capturer</span><span class="p">){</span>
  <span class="c1">// create a cublasFlow capturer</span>
  <span class="k">auto</span> <span class="n">blas</span> <span class="o">=</span> <span class="n">capturer</span><span class="p">.</span><span class="n">make_capturer</span><span class="o">&lt;</span><span class="n">tf</span><span class="o">::</span><span class="n">cublasFlowCapturer</span><span class="o">&gt;</span><span class="p">();</span>

  <span class="c1">// use the base method tf::cudaFlowCapturer::on to capture other functions</span>
  <span class="n">blas</span><span class="o">-&gt;</span><span class="n">on</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">cudaStream_t</span> <span class="n">stream</span><span class="p">){</span>
    <span class="n">cublasSetStream</span><span class="p">(</span><span class="n">blas</span><span class="o">-&gt;</span><span class="n">native_handle</span><span class="p">(),</span> <span class="n">stream</span><span class="p">);</span>
    <span class="n">cublasCherkx</span><span class="p">(</span><span class="n">blas</span><span class="o">-&gt;</span><span class="n">native_handle</span><span class="p">(),</span> <span class="n">your_args</span><span class="p">...);</span>
  <span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;Hermitian rank-k update&quot;</span><span class="p">);</span>

<span class="p">}).</span><span class="n">name</span><span class="p">(</span><span class="s">&quot;capturer&quot;</span><span class="p">);</span></pre><aside class="m-note m-danger"><h4>Warning</h4><p>While <a href="classtf_1_1cublasFlowCapturer.html#a2701b05226ef193e45482c1bb56f93de" class="m-doc">tf::<wbr />cublasFlowCapturer::<wbr />native_handle</a> returns the native cublas handle, you must not change its properties.</p></aside><p>By default, we associate the native cublas handler with <code>CUBLAS_POINTER_MODE_DEVICE</code>. The two scalars, <code>alpha</code> and/or <code>beta</code>, and input/output matrices must be accessible in GPU memory space.</p></section><section id="cublasFlowCapturerKnowMore"><h2><a href="#cublasFlowCapturerKnowMore">Know More About cublasFlow Capturer</a></h2><p>We summarize below resources for you to know more about <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a>:</p><ul><li>Study the reference of <a href="classtf_1_1cublasFlowCapturer.html" class="m-doc">tf::<wbr />cublasFlowCapturer</a> and <a href="classtf_1_1cudaFlowCapturer.html" class="m-doc">tf::<wbr />cudaFlowCapturer</a></li><li>Contribute to <a href="cublas__flow_8hpp.html" class="m-doc">cublas_<wbr />flow.hpp</a> by adding more BLAS methods</li><li>See the complete list of BLAS functions offered by <a href="https://docs.nvidia.com/cuda/cublas/index.html">cuBLAS</a></li></ul></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v1.js"></script>
<script src="searchdata-v1.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Taskflow handbook is part of the <a href="https://taskflow.github.io">Taskflow project</a>, copyright © <a href="https://tsung-wei-huang.github.io/">Dr. Tsung-Wei Huang</a>, 2018&ndash;2020.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.8.20 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
